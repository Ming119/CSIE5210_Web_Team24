<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>閒聊討論區</title>
  <link rel="stylesheet" href="./assets/css/homepage.css">
  <link id="darkModeStylesheet" rel="stylesheet" href="./assets/css/darkmode.css" disabled>
</head>

<body class="body">
  <nav class="navBar">
    <button class="loginBtn" onclick="handleLogin()">登入</button>
    <button class="darkModeContainer" id="darkModeToggle">🌙 夜間模式</button>
  </nav>
  
  <div class="container">
    <div class="categories">
      <ul id="categoryList" style="margin: 0px;">
        <!-- Categories will be generated here -->
      </ul>
    </div>
    <div class="boards" id="boardsContainer">
      <!-- Boards will be generated here -->
    </div>
  </div>
  <script src="assets/js/darkmode.js"></script>
  <script>
    function handleLogin() {
      event.preventDefault();
      window.location.href = 'login.html';
    }

    function goToCategory(index) {
      event.preventDefault();
      window.location.href = 'my_topics.html';
    }

    document.getElementById("darkModeToggle").addEventListener("click", () => {
      document.getElementById("darkModeStylesheet").disabled = false;
      document.body.classList.toggle("dark-mode");
    });

    // Function to create category objects
    function createCategory(name, topics, createdAt, user) {
      return {
        name: name,
        topics: topics,
        createdAt: createdAt,
        user: user
      };
    }

    // Define category objects
    const categories = [];
    const users = ['User1', 'User2', 'User3', 'User4', 'User5'];
    const topics = ['主題1', '主題2', '主題3', '主題4', '主題5'];
    for (let i = 0; i < 5; i++) {
      categories.push(createCategory(
        `分類${String.fromCharCode(65 + i)}`,
        topics,
        `2025-03-0${i + 1} 00:01`,
        users[i]
      ));
    }

    // Generate categories list
    const categoryList = document.getElementById('categoryList');
    categories.forEach((category, index) => {
      const li = document.createElement('li');
      const a = document.createElement('a');
      a.href = './my_topics.html';
      a.className = 'category';
      a.textContent = category.name;
      li.appendChild(a);
      categoryList.appendChild(li);
    });

    // Generate boards
    const boardsContainer = document.getElementById('boardsContainer');
    categories.forEach((category, index) => {
      const boardDiv = document.createElement('div');
      boardDiv.className = 'board';

      const heading = document.createElement('h2');
      heading.className = 'heading';
      heading.textContent = category.name;
      boardDiv.appendChild(heading);

      const table = document.createElement('table');
      table.className = 'table';

      const thead = document.createElement('thead');
      const headerRow = document.createElement('tr');
      headerRow.className = 'tableHeader';
      ['主題', '最後更新時間', '用戶'].forEach(text => {
        const th = document.createElement('td');
        th.textContent = text;
        headerRow.appendChild(th);
      });
      thead.appendChild(headerRow);
      table.appendChild(thead);

      const tbody = document.createElement('tbody');
      category.topics.forEach(topic => {
        const row = document.createElement('tr');
        row.className = 'tableRows';

        const subjectCell = document.createElement('td');
        subjectCell.className = 'subject';
        subjectCell.textContent = topic;
        row.appendChild(subjectCell);

        const lastUpdateCell = document.createElement('td');
        lastUpdateCell.className = 'lastUpdate';
        lastUpdateCell.textContent = '2025-03-01 00:01';
        row.appendChild(lastUpdateCell);

        const usernameCell = document.createElement('td');
        usernameCell.className = 'username';
        usernameCell.textContent = 'User';
        row.appendChild(usernameCell);

        tbody.appendChild(row);
      });
      table.appendChild(tbody);

      const tfoot = document.createElement('tfoot');
      tfoot.className = "tableFooter";
      const footerRow = document.createElement('tr');
      const footerCell = document.createElement('td');
      footerCell.className = 'seeAll';
      footerCell.colSpan = 3;
      const seeAllButton = document.createElement('button');
      seeAllButton.className = 'seeAll';
      seeAllButton.textContent = '全部';
      seeAllButton.onclick = () => goToCategory(index);
      footerCell.appendChild(seeAllButton);
      footerRow.appendChild(footerCell);
      tfoot.appendChild(footerRow);
      table.appendChild(tfoot);

      boardDiv.appendChild(table);
      boardsContainer.appendChild(boardDiv);

      // Add horizontal line between boards
      if (index < categories.length - 1) {
        const hr = document.createElement('hr');
        boardsContainer.appendChild(hr);
      }
    });
  </script>
</body>

<footer class="footer">
  <p>Copyright© 2025 CSIE5210 Web程式設計與應用 113-2 Group 24. All rights reserved.</p>
</footer>

</html>